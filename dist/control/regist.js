!function(a,b,c){b.control.set({name:"regist",par:"",tem:["top_second","icon_place_list","icon_input_list","single_button"],fn:function(d){function e(e){function g(){a("[name='code'] .other span").html("发送动态密码"),a("[name='code'] .other").unbind("tap").bind("tap",function(){return a("[name='picCode'] input").val()?void(a("[name='user'] input").val()&&a("[name='user'] input").val().length?b.api.run("regist_phone_message",{at:e,mobile:a("[name='user'] input").val(),v:a("[name='picCode'] input").val()},function(b){a("[name='code'] .other").unbind("click");var c=60,d=setInterval(function(){0!==c?(a("[name='code'] .other span").html(c+"秒后可再次发送"),c--):(clearInterval(d),g())},1e3)},function(a){b.pop.on("alert",{text:JSON.stringify(a)})}):(b.pop.on("alert",{text:"请填写手机号"}),a("[name='picCode'] img").attr("src",c.sour+"user/mv.jspx?at="+e+"&t="+(new Date).getTime()))):(b.pop.on("alert",{text:"获取动态密码必须先输入验证码"}),!1)})}var h=_.template(d.tem[2])({list:[{name:"user",placehold:"请输入11位手机号",icon:"fa-pad",value:f.phone||"",other:""},{name:"picCode",placehold:"请输入图片验证码",icon:"fa-node",value:"",other:"<img src='"+c.sour+"user/mv.jspx?at="+e+"&t="+(new Date).getTime()+"'/>"},{name:"code",placehold:"请输入短信验证码",icon:"fa-node",value:f.code||"",other:"<span style='font-size:.5rem;display:block;'>发送短信验证码</span>"},{name:"key",placehold:"请输入6-16位字母数字组合密码",icon:"fa-lock",value:f.key||"",other:"",type:"password"},{name:"key2",placehold:"请再次输入密码",icon:"fa-lock",value:f.key2||"",other:"",type:"password"}]}),i=_.template(d.tem[3])({text:"注册",id:"registButton"}),j=_.template(d.tem[1])({place:f.place.name||""});a("#scroller").html(j+h+i),a("[name='picCode'] img").unbind("tap").bind("tap",function(){a(this).attr("src",c.sour+"user/mv.jspx?at="+e+"&t="+(new Date).getTime())}),a("[name='user'] input").unbind("change").bind("change",function(){f.phone=a(this).val()}),a("[name='code'] input").unbind("change").bind("change",function(){f.code=a(this).val()}),a("[name='key'] input").unbind("change").bind("change",function(){f.key=a(this).val()}),a("[name='key2'] input").unbind("change").bind("change",function(){f.key2=a(this).val()}),g(),a(".top_third .leftButton").unbind("tap").bind("tap",function(){window.history.go(-1)}),a("#registButton").unbind("tap").bind("tap",function(){return f.phone.length?f.code.length?f.key.length&&f.key2.length?f.key.length!==f.key2.length?(b.pop.on("alert",{text:JSON.stringify("重复输入密码有误")}),!1):f.place.name?void b.api.run("regist","at="+e+"&mobile="+f.phone+"&t=11&p="+f.key+"&v="+f.code+"&s1="+f.pro+"&s2="+f.place.id+"&pid=&r=",function(a){b.pop.on("alert",{text:"注册成功"}),window.location.hash="index"},function(d){b.pop.on("alert",{text:JSON.stringify(d)}),a("[name='picCode'] img").attr("src",c.sour+"user/mv.jspx?at="+e+"&t="+(new Date).getTime())}):(b.pop.on("alert",{text:JSON.stringify("请选择归属地")}),!1):(b.pop.on("alert",{text:JSON.stringify("请输入密码")}),!1):(b.pop.on("alert",{text:JSON.stringify("请输入验证码")}),!1):(b.pop.on("alert",{text:JSON.stringify("请输入手机号")}),!1)}),a(".icon_input_list.place").unbind("tap").bind("tap",function(){b.cache("regist",f),window.location.hash="searchPlace"}),a("img").load(function(){})}var f={phone:"",code:"",key:"",key2:"",place:{},pro:""};b.cache("regist")&&(f=b.cache("regist"),b.cache("regist",null,!0));var g=_.template(d.tem[0])({left:"",center:"注册"});a("#head").html(g),b.api.at(e)}})}($,app,config);